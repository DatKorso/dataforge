# ТЗ на импорт данных из файла punta_barcodes.xlsx

## 1. Описание источника данных

**Формат файла:** .xlsx, .xls
**Структура листов:** "Sheet" (единственны лист в документе)
**Расположение данных:** Данные начинаются со строки 2
**Наличие заголовков:** Да, строка 1 содержит названия колонок
**Название таблицы в БД** punta_barcodes

## 2. Маппинг данных

| Заголовок Excel | Название в БД | Тип данных | Обязательность |
|-----------------|---------------|------------|----------------|
| Коллекция | collection | VARCHAR(100) | Обязательно |
| Артикул | pn_article | VARCHAR(100) | Обязательно |
| Вид товара | product_type | VARCHAR(50) | Необязательно |
| Внешний код | external_code | VARCHAR(50) | Обязательно |
| Размер | size | VARCHAR(100) | Необязательно |
| Штрихкод | barcode | VARCHAR(50) | Необязательно |
| ТН ВЭД | tn_ved | VARCHAR(50) | Необязательно |

## 3. Правила валидации

**Обязательные поля:**
- Артикул не может быть пустым

## 4. Обработка ошибок

**Дублирующиеся записи:**
- Каждая загрузка нового отчета будет вести к дублированию записей, поэтому нужно перед новой записью очищать все записи указанной коллекции.

**Некорректные данные:**
- Пропустить строку с ошибкой и продолжить обработку
- Записать детальную информацию об ошибке в лог
- В конце импорта показать сводку: обработано/пропущено/ошибок

**Логирование ошибок:**
- Обязательно логировать все ошибки валидации
- Указывать номер строки и тип ошибки
- Сохранять лог в файл с timestamp

**Стратегия:**
- Пропустить строку при ошибке и продолжить обработку
- Не останавливать весь процесс из-за одной некорректной записи

## 5. Дополнительные требования

**Производительность:**
- Использовать транзакции для обеспечения целостности данных
- Создать индексы по полям: pn_article, size, external_code, barcode
- Показывать прогресс обработки пользователю
